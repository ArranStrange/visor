<!-- Generated by SpecStory -->

# Make it reusable (2025-09-23 19:42Z)

_**User (2025-09-23 19:22Z)**_

this should be reuasble

---

_**Assistant**_

I can see you're referring to the mobile detection logic in the `FilmSimCard.tsx` component. This is indeed a common pattern that should be extracted into a reusable hook. Let me create a custom hook for this functionality.


---

## Todo List

- [-] Create a reusable useMobileDetection hook
- [ ] Update FilmSimCard to use the new hook
- [ ] Search for other components that might benefit from this hook

---

Could not find file '/Users/arranstrange/Documents/Coding/visor_full_project/client/src/hooks' in the workspace.

---

<details>
            <summary>Listed directory undefined • **0** results</summary>
        
No results found
</details>

---

Now I'll create a reusable `useMobileDetection` hook:


---



---

## Todo List

- [x] Create a reusable useMobileDetection hook
- [ ] Update FilmSimCard to use the new hook
- [ ] Search for other components that might benefit from this hook

---

Now let me update the `FilmSimCard` component to use the new hook:


---

## Todo List

- [x] Create a reusable useMobileDetection hook
- [-] Update FilmSimCard to use the new hook
- [ ] Search for other components that might benefit from this hook

---

Read file: undefined

---

Read file: undefined

---

Now I need to see the state declaration and imports to properly update the component:


---

Read file: undefined

---

Perfect! Now I can update the component to use the new hook:


---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/FilmSimCard.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: undefined

```diff
@@ -13,4 +13,5 @@
  import AddToListDialog from "./AddToListDialog";
  import { useImageColor } from "../hooks/useImageColor";
+ import { useMobileDetection } from "../hooks/useMobileDetection";
  import FastImage from "./FastImage";
  
```

</details>

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/FilmSimCard.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -60,5 +60,5 @@
    const [addToListOpen, setAddToListOpen] = React.useState(false);
    const [showOptions, setShowOptions] = React.useState(false);
-   const [isMobile, setIsMobile] = React.useState(false);
+   const isMobile = useMobileDetection();
  
    const { offWhiteColor, isAnalyzing } = useImageColor(thumbnail);
```

</details>

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/FilmSimCard.tsx</summary>

undefined

**Chunk 1**
Lines added: undefined, lines removed: 8

```diff
@@ -76,12 +76,4 @@
    }, [isAnalyzing, offWhiteColor]);
  
-   useEffect(() => {
-     const checkMobile = () => {
-       setIsMobile(window.matchMedia("(hover: none)").matches);
-     };
-     checkMobile();
-     window.addEventListener("resize", checkMobile);
-     return () => window.removeEventListener("resize", checkMobile);
-   }, []);
  
    const handleClick = () => {
```

</details>

---

## Todo List

- [x] Create a reusable useMobileDetection hook
- [x] Update FilmSimCard to use the new hook
- [ ] Search for other components that might benefit from this hook

---

Now let me search for other components that might be using similar mobile detection logic:


---

## Todo List

- [x] Create a reusable useMobileDetection hook
- [x] Update FilmSimCard to use the new hook
- [-] Search for other components that might benefit from this hook

---



---

Great! I found several other components using the same mobile detection logic. Let me check these files and update them to use the new hook:


---

Read file: undefined

---

Read file: undefined

---

Read file: undefined

---

Let me search for the mobile detection logic in these files:


---



---



---

Perfect! Now I'll update all three components to use the new hook. Let me start with `BuyMeACoffeeCard`:


---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/BuyMeACoffeeCard.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: undefined

```diff
@@ -1,4 +1,5 @@
  import React, { useEffect } from "react";
  import { Card, Typography, Box, Chip, Stack } from "@mui/material";
+ import { useMobileDetection } from "../hooks/useMobileDetection";
  
  interface BuyMeACoffeeCardProps {
```

</details>

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/BuyMeACoffeeCard.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 10

```diff
@@ -9,14 +9,5 @@
  const BuyMeACoffeeCard: React.FC<BuyMeACoffeeCardProps> = ({ id }) => {
    const [showOptions, setShowOptions] = React.useState(false);
-   const [isMobile, setIsMobile] = React.useState(false);
- 
-   React.useEffect(() => {
-     const checkMobile = () => {
-       setIsMobile(window.matchMedia("(hover: none)").matches);
-     };
-     checkMobile();
-     window.addEventListener("resize", checkMobile);
-     return () => window.removeEventListener("resize", checkMobile);
-   }, []);
+   const isMobile = useMobileDetection();
  
    const handleClick = () => {
```

</details>

---

Now let me update `PresetCard`:


---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/PresetCard.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: undefined

```diff
@@ -5,4 +5,5 @@
  import AddToListDialog from "./AddToListDialog";
  import { useImageColor } from "../hooks/useImageColor";
+ import { useMobileDetection } from "../hooks/useMobileDetection";
  import FastImage from "./FastImage";
  
```

</details>

---

Read file: undefined

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/PresetCard.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 11

```diff
@@ -34,15 +34,5 @@
    const [addToListOpen, setAddToListOpen] = React.useState(false);
    const [showOptions, setShowOptions] = React.useState(false);
-   const [isMobile, setIsMobile] = React.useState(false);
- 
-   // Check if we're on mobile
-   React.useEffect(() => {
-     const checkMobile = () => {
-       setIsMobile(window.matchMedia("(hover: none)").matches);
-     };
-     checkMobile();
-     window.addEventListener("resize", checkMobile);
-     return () => window.removeEventListener("resize", checkMobile);
-   }, []);
+   const isMobile = useMobileDetection();
  
    let imageUrl = placeholderImage;
```

</details>

---

Now let me update `ContentGridLoader`:


---

Read file: undefined

---

Read file: undefined

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/ContentGridLoader.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: undefined

```diff
@@ -9,4 +9,5 @@
  import { CircularProgress, Alert, Box } from "@mui/material";
  import { useContentType } from "../context/ContentTypeFilter";
+ import { useMobileDetection } from "../hooks/useMobileDetection";
  
  import { GET_ALL_PRESETS } from "../graphql/queries/getAllPresets";
```

</details>

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/ContentGridLoader.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -38,5 +38,5 @@
    const [visibleItems, setVisibleItems] = useState(ITEMS_PER_PAGE);
    const containerRef = useRef<HTMLDivElement>(null);
-   const [isMobile, setIsMobile] = useState(false);
+   const isMobile = useMobileDetection();
  
    const { randomizeOrder } = useContentType();
```

</details>

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/ContentGridLoader.tsx</summary>

undefined

**Chunk 1**
Lines added: undefined, lines removed: 8

```diff
@@ -136,12 +136,4 @@
    const hasMore = visibleItems < combined.length;
  
-   useEffect(() => {
-     const checkMobile = () => {
-       setIsMobile(window.matchMedia("(hover: none)").matches);
-     };
-     checkMobile();
-     window.addEventListener("resize", checkMobile);
-     return () => window.removeEventListener("resize", checkMobile);
-   }, []);
  
    if (isError) {
```

</details>

---

Now let me check for any linting errors in the files I've modified:


---



---

Let me fix these linting warnings by removing the unused imports:


---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/ContentGridLoader.tsx</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -7,5 +7,5 @@
  } from "react";
  import { useQuery } from "@apollo/client";
- import { CircularProgress, Alert, Box } from "@mui/material";
+ import { Alert, Box } from "@mui/material";
  import { useContentType } from "../context/ContentTypeFilter";
  import { useMobileDetection } from "../hooks/useMobileDetection";
```

</details>

---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/FilmSimCard.tsx</summary>

undefined

**Chunk 1**
Lines added: undefined, lines removed: 1

```diff
@@ -57,5 +57,4 @@
  }) => {
    const navigate = useNavigate();
-   const [loaded, setLoaded] = React.useState(false);
    const [addToListOpen, setAddToListOpen] = React.useState(false);
    const [showOptions, setShowOptions] = React.useState(false);
```

</details>

---

## Todo List

- [x] Create a reusable useMobileDetection hook
- [x] Update FilmSimCard to use the new hook
- [x] Search for other components that might benefit from this hook

---

Perfect! I've successfully refactored the mobile detection logic into a reusable hook. Here's what I accomplished:

## ✅ **Refactoring Complete**

### **Created a Reusable Hook**
- **`useMobileDetection.ts`** - A custom hook that encapsulates the mobile detection logic using `window.matchMedia("(hover: none)")` and handles resize events

### **Updated 4 Components**
1. **`FilmSimCard.tsx`** - Replaced inline mobile detection with the hook
2. **`BuyMeACoffeeCard.tsx`** - Replaced inline mobile detection with the hook  
3. **`PresetCard.tsx`** - Replaced inline mobile detection with the hook
4. **`ContentGridLoader.tsx`** - Replaced inline mobile detection with the hook

### **Benefits of This Refactoring**
- **DRY Principle**: Eliminated code duplication across 4 components
- **Maintainability**: Mobile detection logic is now centralized in one place
- **Consistency**: All components now use the same mobile detection method
- **Reusability**: The hook can be easily imported and used in any new component
- **Clean Code**: Removed redundant `useEffect` and state management from each component

### **Code Reduction**
- Removed ~8 lines of duplicate code from each component
- Total reduction: ~32 lines of duplicated mobile detection logic
- Added 1 reusable hook with proper TypeScript typing and documentation

The mobile detection logic is now properly abstracted and can be easily maintained, tested, and extended if needed in the future!

---

_**User (2025-09-23 19:22Z)**_

For the code present, we get this error:
```
Cannot find name 'setLoaded'.
```
How can I resolve this? If you propose a fix, please make it concise.

---

_**Assistant**_

I can see the issue! The `setLoaded` function is being called on line 146, but I removed the `loaded` state variable earlier when cleaning up the unused code. However, the `onLoad` callback is still trying to use it.

Let me fix this by removing the `onLoad` callback since it's not being used:


---

<details><summary>Edit file: /Users/arranstrange/Documents/Coding/visor_full_project/client/src/components/FilmSimCard.tsx</summary>

undefined

**Chunk 1**
Lines added: undefined, lines removed: 1

```diff
@@ -144,5 +144,4 @@
          alt={name}
          aspectRatio="2:3"
-         onLoad={() => setLoaded(true)}
          style={{
            position: "absolute",
```

</details>

---

Fixed! I removed the `onLoad={() => setLoaded(true)}` callback since the `loaded` state was removed during the refactoring. The `FastImage` component will still load properly without this callback.

---

